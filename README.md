Download Link: https://assignmentchef.com/product/solved-csci567-homework2-classification
<br>
<h2 id="Problem-2-Classification-(60-points)">Problem 2 Classification</h2>

For this assignment you are asked to implement both binary and multiclass classification using gradient descent to update weight and bias in each iteration. <strong>PLEASE EDIT <code>bm_classify.py</code> ONLY</strong>. Any other changes that cause system issues may lead to 0 point in this part.

<h3 id="Q2.1-Binary-Classification---Perceptron-vs.-Logistic-(28-points)">Q2.1 Binary Classification – Perceptron vs. Logistic</h3>

In our lecture we have been discussing how to do binary classification using different loss. Now it is your time to implement perceptron loss and logistic loss for binary classification. In this problem you are given training set <span id="MathJax-Element-1-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi><mo>=</mo><mrow><mo>{</mo><msubsup><mrow><mo>(</mo><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mo>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>=</mo><mn>1</mn></mrow></msubsup><mo>}</mo></mrow><mo>,</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>&amp;#x2208;</mo><mrow><mo>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>}</mo></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2200;</mi><mi>i</mi><mo>=</mo><mn>1...</mn><mi>N</mi><mo>.</mo></math>"><span id="MathJax-Span-1" class="math"><span id="MathJax-Span-2" class="mrow"><span id="MathJax-Span-3" class="mi">D</span><span id="MathJax-Span-4" class="mo">=</span><span id="MathJax-Span-5" class="mrow"><span id="MathJax-Span-6" class="mo">{</span><span id="MathJax-Span-7" class="msubsup"><span id="MathJax-Span-8" class="mrow"><span id="MathJax-Span-9" class="mo">(</span><span id="MathJax-Span-10" class="msubsup"><span id="MathJax-Span-11" class="mi">x</span><span id="MathJax-Span-12" class="texatom"><span id="MathJax-Span-13" class="mrow"><span id="MathJax-Span-14" class="mi">n</span></span></span></span><span id="MathJax-Span-15" class="mo">,</span><span id="MathJax-Span-16" class="msubsup"><span id="MathJax-Span-17" class="mi">y</span><span id="MathJax-Span-18" class="texatom"><span id="MathJax-Span-19" class="mrow"><span id="MathJax-Span-20" class="mi">n</span></span></span></span><span id="MathJax-Span-21" class="mo">)</span></span><span id="MathJax-Span-22" class="texatom"><span id="MathJax-Span-23" class="mrow"><span id="MathJax-Span-24" class="mi">n</span><span id="MathJax-Span-25" class="mo">=</span><span id="MathJax-Span-26" class="mn">1</span></span></span><span id="MathJax-Span-27" class="texatom"><span id="MathJax-Span-28" class="mrow"><span id="MathJax-Span-29" class="mi">N</span></span></span></span><span id="MathJax-Span-30" class="mo">}</span></span><span id="MathJax-Span-31" class="mo">,</span><span id="MathJax-Span-32" class="msubsup"><span id="MathJax-Span-33" class="mi">y</span><span id="MathJax-Span-34" class="texatom"><span id="MathJax-Span-35" class="mrow"><span id="MathJax-Span-36" class="mi">i</span></span></span></span><span id="MathJax-Span-37" class="mo">∈</span><span id="MathJax-Span-38" class="mrow"><span id="MathJax-Span-39" class="mo">{</span><span id="MathJax-Span-40" class="mn">0</span><span id="MathJax-Span-41" class="mo">,</span><span id="MathJax-Span-42" class="mn">1</span><span id="MathJax-Span-43" class="mo">}</span></span><span id="MathJax-Span-44" class="mi">∀</span><span id="MathJax-Span-45" class="mi">i</span><span id="MathJax-Span-46" class="mo">=</span><span id="MathJax-Span-47" class="mn">1…</span><span id="MathJax-Span-48" class="mi">N</span><span id="MathJax-Span-49" class="mo">.</span></span></span><span class="MJX_Assistive_MathML" role="presentation">D={(xn,yn)Nn=1},yi∈{0,1}∀i=1…N.</span></span> Please note that the labels are not +1 or -1 as we discussed in lectures, so think carefully before you apply formula to this question. Your task is to learn a model <span id="MathJax-Element-2-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><mi>x</mi><mo>+</mo><mi>b</mi></math>"><span id="MathJax-Span-50" class="math"><span id="MathJax-Span-51" class="mrow"><span id="MathJax-Span-52" class="msubsup"><span id="MathJax-Span-53" class="mi">w</span><span id="MathJax-Span-54" class="texatom"><span id="MathJax-Span-55" class="mrow"><span id="MathJax-Span-56" class="mi">T</span></span></span></span><span id="MathJax-Span-57" class="mi">x</span><span id="MathJax-Span-58" class="mo">+</span><span id="MathJax-Span-59" class="mi">b</span></span></span><span class="MJX_Assistive_MathML" role="presentation">wTx+b</span></span> that minimize the given loss. Please find the gradients of the two loss functions by yourself and apply <strong>average</strong> gradient descent to update <span id="MathJax-Element-3-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi><mo>,</mo><mi>b</mi></math>"><span id="MathJax-Span-60" class="math"><span id="MathJax-Span-61" class="mrow"><span id="MathJax-Span-62" class="mi">w</span><span id="MathJax-Span-63" class="mo">,</span><span id="MathJax-Span-64" class="mi">b</span></span></span><span class="MJX_Assistive_MathML" role="presentation">w,b</span></span> in each iteration. For perceptron loss we define <span id="MathJax-Element-4-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Z</mi><mo>=</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mrow><mo>(</mo><msup><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mo>+</mo><mi>b</mi><mo>)</mo></mrow><mo>&amp;gt;</mo><mn>0</mn></math>"><span id="MathJax-Span-65" class="math"><span id="MathJax-Span-66" class="mrow"><span id="MathJax-Span-67" class="mi">Z</span><span id="MathJax-Span-68" class="mo">=</span><span id="MathJax-Span-69" class="msubsup"><span id="MathJax-Span-70" class="mi">y</span><span id="MathJax-Span-71" class="texatom"><span id="MathJax-Span-72" class="mrow"><span id="MathJax-Span-73" class="mi">n</span></span></span></span><span id="MathJax-Span-74" class="mrow"><span id="MathJax-Span-75" class="mo">(</span><span id="MathJax-Span-76" class="msubsup"><span id="MathJax-Span-77" class="mi">w</span><span id="MathJax-Span-78" class="texatom"><span id="MathJax-Span-79" class="mrow"><span id="MathJax-Span-80" class="mi">T</span></span></span></span><span id="MathJax-Span-81" class="msubsup"><span id="MathJax-Span-82" class="mi">x</span><span id="MathJax-Span-83" class="texatom"><span id="MathJax-Span-84" class="mrow"><span id="MathJax-Span-85" class="mi">n</span></span></span></span><span id="MathJax-Span-86" class="mo">+</span><span id="MathJax-Span-87" class="mi">b</span><span id="MathJax-Span-88" class="mo">)</span></span><span id="MathJax-Span-89" class="mo">&gt;</span><span id="MathJax-Span-90" class="mn">0</span></span></span><span class="MJX_Assistive_MathML" role="presentation">Z=yn(wTxn+b)&gt;0</span></span> as correctly classified data.

<ul>

 <li>(8 points) <code>TODO 1</code> For perceptron loss that is find the minimizer of</li>

 <li>(8 points) <code>TODO 2</code> For logistic loss that is find the minimizer of</li>

 <li>(4 points) <code>TODO 3</code> Also you will find out it is convenient to use sigmoid fuction <span id="MathJax-Element-7-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>&amp;#x03C3;</mi><mrow><mo>(</mo><mi>z</mi><mo>)</mo></mrow><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>z</mi></mrow></msup><msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msup></math>"><span id="MathJax-Span-286" class="math"><span id="MathJax-Span-287" class="mrow"><span id="MathJax-Span-288" class="mi">σ</span><span id="MathJax-Span-289" class="mrow"><span id="MathJax-Span-290" class="mo">(</span><span id="MathJax-Span-291" class="mi">z</span><span id="MathJax-Span-292" class="mo">)</span></span><span id="MathJax-Span-293" class="mo">=</span><span id="MathJax-Span-294" class="mo">(</span><span id="MathJax-Span-295" class="mn">1</span><span id="MathJax-Span-296" class="mo">+</span><span id="MathJax-Span-297" class="msubsup"><span id="MathJax-Span-298" class="mi">e</span><span id="MathJax-Span-299" class="texatom"><span id="MathJax-Span-300" class="mrow"><span id="MathJax-Span-301" class="mo">−</span><span id="MathJax-Span-302" class="mi">z</span></span></span></span><span id="MathJax-Span-303" class="msubsup"><span id="MathJax-Span-304" class="mo">)</span><span id="MathJax-Span-305" class="texatom"><span id="MathJax-Span-306" class="mrow"><span id="MathJax-Span-307" class="mo">−</span><span id="MathJax-Span-308" class="mn">1</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">σ(z)=(1+e−z)−1</span></span> for logistic loss, so please complete it. You can use this function in <code>TODO 2</code>.</li>

 <li>(4 points for each)<code>TODO 4</code> <code>TODO 5</code> After you learn the models, how do you know it is good enough? The intuitive way is to make some predictions to see if those predicted results are correct or not. Here we want you complete the prediction functions. It will be like something greater than 0 and something put into sigmoid function greater than 0.5. You may find out an interesting fact here.</li>

</ul>

After you finish the 5 <code>TODO</code>s above in <code>bm_classify.py</code>, you can run <code>binary.sh</code> to test it. If your code is programmed correctly, you should see <code>binary.out</code> as an output file keeping taining and testing accurancies of two loss functions for three datasets. You will see how similar between perceptron loss and logistic loss. Quite interesting isn’t it? Can you figure out why this happends? We will leave this open question to you.

Two of the datasets you are going to do binary classification:

<ul>

 <li>Synthetic data:<img decoding="async" width="400" data-src="Synthetic_data.png" class="lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">

  <noscript>

   <img decoding="async" src="Synthetic_data.png" width="400">

  </noscript></li>

 <li>Two Moon data:<img decoding="async" width="400" data-src="Two_Moon_data.png" class="lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">

  <noscript>

   <img decoding="async" src="Two_Moon_data.png" width="400">

  </noscript></li>

</ul>

<h3 id="Q2.2-Multiclass-classification---SGD-vs.-GD-(32-points)">Q2.2 Multiclass classification – SGD vs. GD</h3>

Well done! Ready to take our next challenge? Let’s get into multiclass classification. In this question you are going to build a model to classify data into more than just two classes. Also you are going to implement both <span id="MathJax-Element-8-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-309" class="math"><span id="MathJax-Span-310" class="mrow"><span id="MathJax-Span-311" class="mi">S</span><span id="MathJax-Span-312" class="mi">G</span><span id="MathJax-Span-313" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">SGD</span></span> and <span id="MathJax-Element-9-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-314" class="math"><span id="MathJax-Span-315" class="mrow"><span id="MathJax-Span-316" class="mi">G</span><span id="MathJax-Span-317" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">GD</span></span> for multiclass classification and compare performances of the two approaches. Training dataset are similar to question Q2.1, but <span id="MathJax-Element-10-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>&amp;#x2208;</mo><mrow><mo>{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mi>C</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>}</mo></mrow><mi mathvariant=&quot;normal&quot;>&amp;#x2200;</mi><mi>i</mi><mo>=</mo><mn>1...</mn><mi>N</mi><mo>.</mo></math>"><span id="MathJax-Span-318" class="math"><span id="MathJax-Span-319" class="mrow"><span id="MathJax-Span-320" class="msubsup"><span id="MathJax-Span-321" class="mi">y</span><span id="MathJax-Span-322" class="texatom"><span id="MathJax-Span-323" class="mrow"><span id="MathJax-Span-324" class="mi">i</span></span></span></span><span id="MathJax-Span-325" class="mo">∈</span><span id="MathJax-Span-326" class="mrow"><span id="MathJax-Span-327" class="mo">{</span><span id="MathJax-Span-328" class="mn">0</span><span id="MathJax-Span-329" class="mo">,</span><span id="MathJax-Span-330" class="mn">1</span><span id="MathJax-Span-331" class="mo">,</span><span id="MathJax-Span-332" class="mo">.</span><span id="MathJax-Span-333" class="mo">.</span><span id="MathJax-Span-334" class="mo">.</span><span id="MathJax-Span-335" class="mo">,</span><span id="MathJax-Span-336" class="mi">C</span><span id="MathJax-Span-337" class="mo">−</span><span id="MathJax-Span-338" class="mn">1</span><span id="MathJax-Span-339" class="mo">}</span></span><span id="MathJax-Span-340" class="mi">∀</span><span id="MathJax-Span-341" class="mi">i</span><span id="MathJax-Span-342" class="mo">=</span><span id="MathJax-Span-343" class="mn">1…</span><span id="MathJax-Span-344" class="mi">N</span><span id="MathJax-Span-345" class="mo">.</span></span></span><span class="MJX_Assistive_MathML" role="presentation">yi∈{0,1,…,C−1}∀i=1…N.</span></span> Your task is to learn models for multiclass classification based on minimizing logistic loss.

Here is a short review of <span id="MathJax-Element-11-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-346" class="math"><span id="MathJax-Span-347" class="mrow"><span id="MathJax-Span-348" class="mi">S</span><span id="MathJax-Span-349" class="mi">G</span><span id="MathJax-Span-350" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">SGD</span></span>.

From the lecture we know multiclass logistic loss is

Here, <span id="MathJax-Element-13-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mi>k</mi></msub></math>"><span id="MathJax-Span-419" class="math"><span id="MathJax-Span-420" class="mrow"><span id="MathJax-Span-421" class="msubsup"><span id="MathJax-Span-422" class="mi">w</span><span id="MathJax-Span-423" class="mi">k</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">wk</span></span> is the weight vector for class <span id="MathJax-Element-14-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>"><span id="MathJax-Span-424" class="math"><span id="MathJax-Span-425" class="mrow"><span id="MathJax-Span-426" class="mi">k</span></span></span><span class="MJX_Assistive_MathML" role="presentation">k</span></span> and <span id="MathJax-Element-15-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>y</mi><mi>n</mi></msub></mrow></msub></math>"><span id="MathJax-Span-427" class="math"><span id="MathJax-Span-428" class="mrow"><span id="MathJax-Span-429" class="msubsup"><span id="MathJax-Span-430" class="mi">w</span><span id="MathJax-Span-431" class="texatom"><span id="MathJax-Span-432" class="mrow"><span id="MathJax-Span-433" class="msubsup"><span id="MathJax-Span-434" class="mi">y</span><span id="MathJax-Span-435" class="mi">n</span></span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">wyn</span></span> is the weight vector for class <span id="MathJax-Element-16-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mi>n</mi></msub></math>"><span id="MathJax-Span-436" class="math"><span id="MathJax-Span-437" class="mrow"><span id="MathJax-Span-438" class="msubsup"><span id="MathJax-Span-439" class="mi">y</span><span id="MathJax-Span-440" class="mi">n</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">yn</span></span>. <span id="MathJax-Element-17-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>"><span id="MathJax-Span-441" class="math"><span id="MathJax-Span-442" class="mrow"><span id="MathJax-Span-443" class="mi">k</span></span></span><span class="MJX_Assistive_MathML" role="presentation">k</span></span> is in range [0, C-1]. Now we try to apply <span id="MathJax-Element-18-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-444" class="math"><span id="MathJax-Span-445" class="mrow"><span id="MathJax-Span-446" class="mi">S</span><span id="MathJax-Span-447" class="mi">G</span><span id="MathJax-Span-448" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">SGD</span></span>. First we randomly pick a data <span id="MathJax-Element-19-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></math>"><span id="MathJax-Span-449" class="math"><span id="MathJax-Span-450" class="mrow"><span id="MathJax-Span-451" class="msubsup"><span id="MathJax-Span-452" class="mi">x</span><span id="MathJax-Span-453" class="texatom"><span id="MathJax-Span-454" class="mrow"><span id="MathJax-Span-455" class="mi">n</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">xn</span></span> and minimize logistic loss

And then find the derivative <span id="MathJax-Element-21-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mo>&amp;#x25BD;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>w</mi></mrow></msub><mi>g</mi><mrow><mo>(</mo><mi>W</mi><mo>)</mo></mrow></math>"><span id="MathJax-Span-514" class="math"><span id="MathJax-Span-515" class="mrow"><span id="MathJax-Span-516" class="msubsup"><span id="MathJax-Span-517" class="mo">▽</span><span id="MathJax-Span-518" class="texatom"><span id="MathJax-Span-519" class="mrow"><span id="MathJax-Span-520" class="mi">w</span></span></span></span><span id="MathJax-Span-521" class="mi">g</span><span id="MathJax-Span-522" class="mrow"><span id="MathJax-Span-523" class="mo">(</span><span id="MathJax-Span-524" class="mi">W</span><span id="MathJax-Span-525" class="mo">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">▽wg(W)</span></span>, where <span id="MathJax-Element-22-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mo>&amp;#x25BD;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>w</mi></mrow></msub><mi>g</mi><mrow><mo>(</mo><mi>W</mi><mo>)</mo></mrow></math>"><span id="MathJax-Span-526" class="math"><span id="MathJax-Span-527" class="mrow"><span id="MathJax-Span-528" class="msubsup"><span id="MathJax-Span-529" class="mo">▽</span><span id="MathJax-Span-530" class="texatom"><span id="MathJax-Span-531" class="mrow"><span id="MathJax-Span-532" class="mi">w</span></span></span></span><span id="MathJax-Span-533" class="mi">g</span><span id="MathJax-Span-534" class="mrow"><span id="MathJax-Span-535" class="mo">(</span><span id="MathJax-Span-536" class="mi">W</span><span id="MathJax-Span-537" class="mo">)</span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">▽wg(W)</span></span> is a <span id="MathJax-Element-23-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi></math>"><span id="MathJax-Span-538" class="math"><span id="MathJax-Span-539" class="mrow"><span id="MathJax-Span-540" class="mi">C</span></span></span><span class="MJX_Assistive_MathML" role="presentation">C</span></span>x<span id="MathJax-Element-24-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi></math>"><span id="MathJax-Span-541" class="math"><span id="MathJax-Span-542" class="mrow"><span id="MathJax-Span-543" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">D</span></span> matrix.

Let’s look at each row k.

If <span id="MathJax-Element-25-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2260;</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></math>"><span id="MathJax-Span-544" class="math"><span id="MathJax-Span-545" class="mrow"><span id="MathJax-Span-546" class="mi">k</span><span id="MathJax-Span-547" class="mo">≠</span><span id="MathJax-Span-548" class="msubsup"><span id="MathJax-Span-549" class="mi">y</span><span id="MathJax-Span-550" class="texatom"><span id="MathJax-Span-551" class="mrow"><span id="MathJax-Span-552" class="mi">n</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">k≠yn</span></span>:

else:

where <span id="MathJax-Element-28-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>P</mi></mrow></math>"><span id="MathJax-Span-855" class="math"><span id="MathJax-Span-856" class="mrow"><span id="MathJax-Span-857" class="texatom"><span id="MathJax-Span-858" class="mrow"><span id="MathJax-Span-859" class="mi">P</span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">P</span></span> is softmax function.

In the end, our update for <span id="MathJax-Element-29-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>W</mi></math>"><span id="MathJax-Span-860" class="math"><span id="MathJax-Span-861" class="mrow"><span id="MathJax-Span-862" class="mi">W</span></span></span><span class="MJX_Assistive_MathML" role="presentation">W</span></span> is

That is the whole idea of <span id="MathJax-Element-31-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-959" class="math"><span id="MathJax-Span-960" class="mrow"><span id="MathJax-Span-961" class="mi">S</span><span id="MathJax-Span-962" class="mi">G</span><span id="MathJax-Span-963" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">SGD</span></span> of logistic loss for multiclass classification.

<ul>

 <li>(8 points) <code>TODO 6</code> Complete the <span id="MathJax-Element-32-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-964" class="math"><span id="MathJax-Span-965" class="mrow"><span id="MathJax-Span-966" class="mi">S</span><span id="MathJax-Span-967" class="mi">G</span><span id="MathJax-Span-968" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">SGD</span></span> part in <code>def multiclass_train</code>, and don’t forget the bias <span id="MathJax-Element-33-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>b</mi></math>"><span id="MathJax-Span-969" class="math"><span id="MathJax-Span-970" class="mrow"><span id="MathJax-Span-971" class="mi">b</span></span></span><span class="MJX_Assistive_MathML" role="presentation">b</span></span>. To randomly pick a data from dataset, you can use <code>np.random.choice</code> one time in each iteration.</li>

 <li>(16 points) <code>TODO 7</code> Complete the <span id="MathJax-Element-34-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-972" class="math"><span id="MathJax-Span-973" class="mrow"><span id="MathJax-Span-974" class="mi">G</span><span id="MathJax-Span-975" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">GD</span></span> part in <code>def multiclass_train</code>. Compare to <span id="MathJax-Element-35-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-976" class="math"><span id="MathJax-Span-977" class="mrow"><span id="MathJax-Span-978" class="mi">S</span><span id="MathJax-Span-979" class="mi">G</span><span id="MathJax-Span-980" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">SGD</span></span>, <span id="MathJax-Element-36-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-981" class="math"><span id="MathJax-Span-982" class="mrow"><span id="MathJax-Span-983" class="mi">G</span><span id="MathJax-Span-984" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">GD</span></span> does not randomly pick a data <span id="MathJax-Element-37-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></math>"><span id="MathJax-Span-985" class="math"><span id="MathJax-Span-986" class="mrow"><span id="MathJax-Span-987" class="msubsup"><span id="MathJax-Span-988" class="mi">x</span><span id="MathJax-Span-989" class="texatom"><span id="MathJax-Span-990" class="mrow"><span id="MathJax-Span-991" class="mi">n</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">xn</span></span>. Instead, <span id="MathJax-Element-38-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-992" class="math"><span id="MathJax-Span-993" class="mrow"><span id="MathJax-Span-994" class="mi">G</span><span id="MathJax-Span-995" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">GD</span></span> considers all training data points to compute derivative. Please think about how to compute <span id="MathJax-Element-39-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-996" class="math"><span id="MathJax-Span-997" class="mrow"><span id="MathJax-Span-998" class="mi">G</span><span id="MathJax-Span-999" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">GD</span></span>, and again we want <strong>average</strong> gradient descent. Also there is a tricky point. When dataset is large, <span id="MathJax-Element-40-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-1000" class="math"><span id="MathJax-Span-1001" class="mrow"><span id="MathJax-Span-1002" class="mi">G</span><span id="MathJax-Span-1003" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">GD</span></span> will takes a large amount of time. How to reduce the time? Make sure you use <strong>numpy programming</strong> instead of nested for loops, otherwise you will not finish your test on Vocareum within the time limit.</li>

</ul>

Hint 1: If you need to run a for loop for <span id="MathJax-Element-41-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>"><span id="MathJax-Span-1004" class="math"><span id="MathJax-Span-1005" class="mrow"><span id="MathJax-Span-1006" class="mi">N</span></span></span><span class="MJX_Assistive_MathML" role="presentation">N</span></span> times to accumulate <span id="MathJax-Element-42-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi></math>"><span id="MathJax-Span-1007" class="math"><span id="MathJax-Span-1008" class="mrow"><span id="MathJax-Span-1009" class="mi">C</span></span></span><span class="MJX_Assistive_MathML" role="presentation">C</span></span>x<span id="MathJax-Element-43-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>D</mi></math>"><span id="MathJax-Span-1010" class="math"><span id="MathJax-Span-1011" class="mrow"><span id="MathJax-Span-1012" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">D</span></span> matrices, why not design an equivalent computation as a <span id="MathJax-Element-44-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi></math>"><span id="MathJax-Span-1013" class="math"><span id="MathJax-Span-1014" class="mrow"><span id="MathJax-Span-1015" class="mi">C</span></span></span><span class="MJX_Assistive_MathML" role="presentation">C</span></span>x<span id="MathJax-Element-45-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>"><span id="MathJax-Span-1016" class="math"><span id="MathJax-Span-1017" class="mrow"><span id="MathJax-Span-1018" class="mi">N</span></span></span><span class="MJX_Assistive_MathML" role="presentation">N</span></span> matrix dot another <span id="MathJax-Element-46-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mi>x</mi><mi>D</mi></math>"><span id="MathJax-Span-1019" class="math"><span id="MathJax-Span-1020" class="mrow"><span id="MathJax-Span-1021" class="mi">N</span><span id="MathJax-Span-1022" class="mi">x</span><span id="MathJax-Span-1023" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">NxD</span></span> matrix.

Hint 2: You may find it useful to use a special (one-hot) representation of the labels, where each label <span id="MathJax-Element-47-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>"><span id="MathJax-Span-1024" class="math"><span id="MathJax-Span-1025" class="mrow"><span id="MathJax-Span-1026" class="msubsup"><span id="MathJax-Span-1027" class="mi">y</span><span id="MathJax-Span-1028" class="texatom"><span id="MathJax-Span-1029" class="mrow"><span id="MathJax-Span-1030" class="mi">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">yi</span></span> is represented as a row of zeros with a single 1 in the column, that corresponds to the class <span id="MathJax-Element-48-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>"><span id="MathJax-Span-1031" class="math"><span id="MathJax-Span-1032" class="mrow"><span id="MathJax-Span-1033" class="msubsup"><span id="MathJax-Span-1034" class="mi">y</span><span id="MathJax-Span-1035" class="texatom"><span id="MathJax-Span-1036" class="mrow"><span id="MathJax-Span-1037" class="mi">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">yi</span></span>. So this one-hot should be an <span id="MathJax-Element-49-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>"><span id="MathJax-Span-1038" class="math"><span id="MathJax-Span-1039" class="mrow"><span id="MathJax-Span-1040" class="mi">N</span></span></span><span class="MJX_Assistive_MathML" role="presentation">N</span></span>x<span id="MathJax-Element-50-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>C</mi></math>"><span id="MathJax-Span-1041" class="math"><span id="MathJax-Span-1042" class="mrow"><span id="MathJax-Span-1043" class="mi">C</span></span></span><span class="MJX_Assistive_MathML" role="presentation">C</span></span> matrix.

Advice: To avoid numerical issues such as overflow and underflow caused by <code>np.exp</code>. Let <span id="MathJax-Element-51-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>"><span id="MathJax-Span-1044" class="math"><span id="MathJax-Span-1045" class="mrow"><span id="MathJax-Span-1046" class="mi">x</span></span></span><span class="MJX_Assistive_MathML" role="presentation">x</span></span> be a input vector to the softmax function. Use <span id="MathJax-Element-52-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mo>=</mo><mi>x</mi><mo>&amp;#x2212;</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>"><span id="MathJax-Span-1047" class="math"><span id="MathJax-Span-1048" class="mrow"><span id="MathJax-Span-1049" class="texatom"><span id="MathJax-Span-1050" class="mrow"><span id="MathJax-Span-1051" class="munderover"><span id="MathJax-Span-1052" class="mi">x</span><span id="MathJax-Span-1053" class="mo">~</span></span></span></span><span id="MathJax-Span-1054" class="mo">=</span><span id="MathJax-Span-1055" class="mi">x</span><span id="MathJax-Span-1056" class="mo">−</span><span id="MathJax-Span-1057" class="mi">m</span><span id="MathJax-Span-1058" class="mi">a</span><span id="MathJax-Span-1059" class="mi">x</span><span id="MathJax-Span-1060" class="mo">(</span><span id="MathJax-Span-1061" class="mi">x</span><span id="MathJax-Span-1062" class="mo">)</span></span></span><span class="MJX_Assistive_MathML" role="presentation">x~=x−max(x)</span></span> instead of using <span id="MathJax-Element-53-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>"><span id="MathJax-Span-1063" class="math"><span id="MathJax-Span-1064" class="mrow"><span id="MathJax-Span-1065" class="mi">x</span></span></span><span class="MJX_Assistive_MathML" role="presentation">x</span></span> directly for the softmax function <span id="MathJax-Element-54-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>"><span id="MathJax-Span-1066" class="math"><span id="MathJax-Span-1067" class="mrow"><span id="MathJax-Span-1068" class="mi">x</span></span></span><span class="MJX_Assistive_MathML" role="presentation">x</span></span> . That is, if you want to compute <span id="MathJax-Element-55-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub></math>"><span id="MathJax-Span-1069" class="math"><span id="MathJax-Span-1070" class="mrow"><span id="MathJax-Span-1071" class="mi">f</span><span id="MathJax-Span-1072" class="mo">(</span><span id="MathJax-Span-1073" class="mi">x</span><span id="MathJax-Span-1074" class="msubsup"><span id="MathJax-Span-1075" class="mo">)</span><span id="MathJax-Span-1076" class="texatom"><span id="MathJax-Span-1077" class="mrow"><span id="MathJax-Span-1078" class="mi">i</span></span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">f(x)i</span></span> , compute <span id="MathJax-Element-56-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><msub><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow><mrow><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>D</mi></mrow></munderover><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mover><mi>x</mi><mo stretchy=&quot;false&quot;>&amp;#x007E;</mo></mover></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></mrow></mfrac></math>"><span id="MathJax-Span-1079" class="math"><span id="MathJax-Span-1080" class="mrow"><span id="MathJax-Span-1081" class="mi">f</span><span id="MathJax-Span-1082" class="mo">(</span><span id="MathJax-Span-1083" class="texatom"><span id="MathJax-Span-1084" class="mrow"><span id="MathJax-Span-1085" class="munderover"><span id="MathJax-Span-1086" class="mi">x</span><span id="MathJax-Span-1087" class="mo">~</span></span></span></span><span id="MathJax-Span-1088" class="msubsup"><span id="MathJax-Span-1089" class="mo">)</span><span id="MathJax-Span-1090" class="texatom"><span id="MathJax-Span-1091" class="mrow"><span id="MathJax-Span-1092" class="mi">i</span></span></span></span><span id="MathJax-Span-1093" class="mo">=</span><span id="MathJax-Span-1094" class="mfrac"><span id="MathJax-Span-1095" class="mrow"><span id="MathJax-Span-1096" class="mi">e</span><span id="MathJax-Span-1097" class="mi">x</span><span id="MathJax-Span-1098" class="mi">p</span><span id="MathJax-Span-1099" class="mo">(</span><span id="MathJax-Span-1100" class="msubsup"><span id="MathJax-Span-1101" class="texatom"><span id="MathJax-Span-1102" class="mrow"><span id="MathJax-Span-1103" class="munderover"><span id="MathJax-Span-1104" class="mi">x</span><span id="MathJax-Span-1105" class="mo">~</span></span></span></span><span id="MathJax-Span-1106" class="texatom"><span id="MathJax-Span-1107" class="mrow"><span id="MathJax-Span-1108" class="mi">i</span></span></span></span><span id="MathJax-Span-1109" class="mo">)</span></span><span id="MathJax-Span-1110" class="mrow"><span id="MathJax-Span-1111" class="munderover"><span id="MathJax-Span-1112" class="mo">∑</span><span id="MathJax-Span-1113" class="texatom"><span id="MathJax-Span-1114" class="mrow"><span id="MathJax-Span-1115" class="mi">D</span></span></span><span id="MathJax-Span-1116" class="texatom"><span id="MathJax-Span-1117" class="mrow"><span id="MathJax-Span-1118" class="mi">j</span><span id="MathJax-Span-1119" class="mo">=</span><span id="MathJax-Span-1120" class="mn">1</span></span></span></span><span id="MathJax-Span-1121" class="mi">e</span><span id="MathJax-Span-1122" class="mi">x</span><span id="MathJax-Span-1123" class="mi">p</span><span id="MathJax-Span-1124" class="mo">(</span><span id="MathJax-Span-1125" class="msubsup"><span id="MathJax-Span-1126" class="texatom"><span id="MathJax-Span-1127" class="mrow"><span id="MathJax-Span-1128" class="munderover"><span id="MathJax-Span-1129" class="mi">x</span><span id="MathJax-Span-1130" class="mo">~</span></span></span></span><span id="MathJax-Span-1131" class="texatom"><span id="MathJax-Span-1132" class="mrow"><span id="MathJax-Span-1133" class="mi">j</span></span></span></span><span id="MathJax-Span-1134" class="mo">)</span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation">f(x~)i=exp(x~i)∑j=1Dexp(x~j)</span></span> instead, which is clearly mathematically equivalent but numerically more stable.

<ul>

 <li>(8 points) <code>TODO 8</code> You need to complete the predict function in <code>def multiclass_predict</code>.</li>

</ul>

After you complete <code>TODO 6</code> <code>TODO 7</code> <code>TODO 8</code>, please run <code>multiclass.sh</code> to test your code. If your code is programmed correctly, you should see <code>multiclass.out</code> as a output file keeping processing time, taining and testing accurancies of <span id="MathJax-Element-57-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-1135" class="math"><span id="MathJax-Span-1136" class="mrow"><span id="MathJax-Span-1137" class="mi">S</span><span id="MathJax-Span-1138" class="mi">G</span><span id="MathJax-Span-1139" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">SGD</span></span> and <span id="MathJax-Element-58-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-1140" class="math"><span id="MathJax-Span-1141" class="mrow"><span id="MathJax-Span-1142" class="mi">G</span><span id="MathJax-Span-1143" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">GD</span></span> for each given dataset. You shall see how fast <span id="MathJax-Element-59-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-1144" class="math"><span id="MathJax-Span-1145" class="mrow"><span id="MathJax-Span-1146" class="mi">S</span><span id="MathJax-Span-1147" class="mi">G</span><span id="MathJax-Span-1148" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">SGD</span></span> process compared to <span id="MathJax-Element-60-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-1149" class="math"><span id="MathJax-Span-1150" class="mrow"><span id="MathJax-Span-1151" class="mi">G</span><span id="MathJax-Span-1152" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">GD</span></span>, but its accuracy is hard to catch up with the other’s. One more open question to leave you. Is there any chance that <span id="MathJax-Element-61-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>S</mi><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-1153" class="math"><span id="MathJax-Span-1154" class="mrow"><span id="MathJax-Span-1155" class="mi">S</span><span id="MathJax-Span-1156" class="mi">G</span><span id="MathJax-Span-1157" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">SGD</span></span> reach to the same accuracy as <span id="MathJax-Element-62-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi><mi>D</mi></math>"><span id="MathJax-Span-1158" class="math"><span id="MathJax-Span-1159" class="mrow"><span id="MathJax-Span-1160" class="mi">G</span><span id="MathJax-Span-1161" class="mi">D</span></span></span><span class="MJX_Assistive_MathML" role="presentation">GD</span></span> does using less time?

That is all for this assignment.

Scatter plot of a sample toy dataset for multicalss classification:

<img decoding="async" width="400" data-src="Toy_data_multiclass.png" class="lazyload" src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==">

 <noscript>

  <img decoding="async" src="Toy_data_multiclass.png" width="400">

 </noscript>

5/5 - (1 vote)

<span id="MathJax-Element-5-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>F</mi><mrow><mo>(</mo><mi>w</mi><mo>,</mo><mi>b</mi><mo>)</mo></mrow><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></munderover><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>e</mi><mi>r</mi><mi>c</mi><mi>e</mi><mi>p</mi><mi>t</mi><mi>r</mi><mi>o</mi><mi>n</mi></mrow></msub><mrow><mo>(</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mrow><mo>(</mo><msup><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mo>+</mo><mi>b</mi><mo>)</mo></mrow><mo>)</mo></mrow><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></munderover><mi>M</mi><mi>A</mi><mi>X</mi><mrow><mo>(</mo><mn>0</mn><mo>,</mo><mo>&amp;#x2212;</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mrow><mo>(</mo><msup><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mo>+</mo><mi>b</mi><mo>)</mo></mrow><mo>)</mo></mrow></math>"><span id="MathJax-Span-91" class="math"><span id="MathJax-Span-92" class="mrow"><span id="MathJax-Span-93" class="mi">F</span><span id="MathJax-Span-94" class="mrow"><span id="MathJax-Span-95" class="mo">(</span><span id="MathJax-Span-96" class="mi">w</span><span id="MathJax-Span-97" class="mo">,</span><span id="MathJax-Span-98" class="mi">b</span><span id="MathJax-Span-99" class="mo">)</span></span><span id="MathJax-Span-100" class="mo">=</span><span id="MathJax-Span-101" class="munderover"><span id="MathJax-Span-102" class="mo">∑</span><span id="MathJax-Span-103" class="texatom"><span id="MathJax-Span-104" class="mrow"><span id="MathJax-Span-105" class="mi">n</span><span id="MathJax-Span-106" class="mo">=</span><span id="MathJax-Span-107" class="mn">1</span></span></span><span id="MathJax-Span-108" class="texatom"><span id="MathJax-Span-109" class="mrow"><span id="MathJax-Span-110" class="mi">N</span></span></span></span><span id="MathJax-Span-111" class="msubsup"><span id="MathJax-Span-112" class="mi">L</span><span id="MathJax-Span-113" class="texatom"><span id="MathJax-Span-114" class="mrow"><span id="MathJax-Span-115" class="mi">p</span><span id="MathJax-Span-116" class="mi">e</span><span id="MathJax-Span-117" class="mi">r</span><span id="MathJax-Span-118" class="mi">c</span><span id="MathJax-Span-119" class="mi">e</span><span id="MathJax-Span-120" class="mi">p</span><span id="MathJax-Span-121" class="mi">t</span><span id="MathJax-Span-122" class="mi">r</span><span id="MathJax-Span-123" class="mi">o</span><span id="MathJax-Span-124" class="mi">n</span></span></span></span><span id="MathJax-Span-125" class="mrow"><span id="MathJax-Span-126" class="mo">(</span><span id="MathJax-Span-127" class="msubsup"><span id="MathJax-Span-128" class="mi">y</span><span id="MathJax-Span-129" class="texatom"><span id="MathJax-Span-130" class="mrow"><span id="MathJax-Span-131" class="mi">n</span></span></span></span><span id="MathJax-Span-132" class="mrow"><span id="MathJax-Span-133" class="mo">(</span><span id="MathJax-Span-134" class="msubsup"><span id="MathJax-Span-135" class="mi">w</span><span id="MathJax-Span-136" class="texatom"><span id="MathJax-Span-137" class="mrow"><span id="MathJax-Span-138" class="mi">T</span></span></span></span><span id="MathJax-Span-139" class="msubsup"><span id="MathJax-Span-140" class="mi">x</span><span id="MathJax-Span-141" class="texatom"><span id="MathJax-Span-142" class="mrow"><span id="MathJax-Span-143" class="mi">n</span></span></span></span><span id="MathJax-Span-144" class="mo">+</span><span id="MathJax-Span-145" class="mi">b</span><span id="MathJax-Span-146" class="mo">)</span></span><span id="MathJax-Span-147" class="mo">)</span></span><span id="MathJax-Span-148" class="mo">=</span><span id="MathJax-Span-149" class="munderover"><span id="MathJax-Span-150" class="mo">∑</span><span id="MathJax-Span-151" class="texatom"><span id="MathJax-Span-152" class="mrow"><span id="MathJax-Span-153" class="mi">n</span><span id="MathJax-Span-154" class="mo">=</span><span id="MathJax-Span-155" class="mn">1</span></span></span><span id="MathJax-Span-156" class="texatom"><span id="MathJax-Span-157" class="mrow"><span id="MathJax-Span-158" class="mi">N</span></span></span></span><span id="MathJax-Span-159" class="mi">M</span><span id="MathJax-Span-160" class="mi">A</span><span id="MathJax-Span-161" class="mi">X</span><span id="MathJax-Span-162" class="mrow"><span id="MathJax-Span-163" class="mo">(</span><span id="MathJax-Span-164" class="mn">0</span><span id="MathJax-Span-165" class="mo">,</span><span id="MathJax-Span-166" class="mo">−</span><span id="MathJax-Span-167" class="msubsup"><span id="MathJax-Span-168" class="mi">y</span><span id="MathJax-Span-169" class="texatom"><span id="MathJax-Span-170" class="mrow"><span id="MathJax-Span-171" class="mi">n</span></span></span></span><span id="MathJax-Span-172" class="mrow"><span id="MathJax-Span-173" class="mo">(</span><span id="MathJax-Span-174" class="msubsup"><span id="MathJax-Span-175" class="mi">w</span><span id="MathJax-Span-176" class="texatom"><span id="MathJax-Span-177" class="mrow"><span id="MathJax-Span-178" class="mi">T</span></span></span></span><span id="MathJax-Span-179" class="msubsup"><span id="MathJax-Span-180" class="mi">x</span><span id="MathJax-Span-181" class="texatom"><span id="MathJax-Span-182" class="mrow"><span id="MathJax-Span-183" class="mi">n</span></span></span></span><span id="MathJax-Span-184" class="mo">+</span><span id="MathJax-Span-185" class="mi">b</span><span id="MathJax-Span-186" class="mo">)</span></span><span id="MathJax-Span-187" class="mo">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">F(w,b)=∑n=1NLperceptron(yn(wTxn+b))=∑n=1NMAX(0,−yn(wTxn+b))</span></span>

<span id="MathJax-Element-6-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>F</mi><mrow><mo>(</mo><mi>w</mi><mo>,</mo><mi>b</mi><mo>)</mo></mrow><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></munderover><msub><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>l</mi><mi>o</mi><mi>g</mi><mi>i</mi><mi>s</mi><mi>t</mi><mi>i</mi><mi>c</mi></mrow></msub><mrow><mo>(</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mrow><mo>(</mo><msup><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mo>+</mo><mi>b</mi><mo>)</mo></mrow><mo>)</mo></mrow><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></munderover><mi>l</mi><mi>n</mi><mrow><mo>(</mo><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mrow><mo>(</mo><msup><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mo>+</mo><mi>b</mi><mo>)</mo></mrow></mrow></msup><mo>)</mo></mrow></math>"><span id="MathJax-Span-188" class="math"><span id="MathJax-Span-189" class="mrow"><span id="MathJax-Span-190" class="mi">F</span><span id="MathJax-Span-191" class="mrow"><span id="MathJax-Span-192" class="mo">(</span><span id="MathJax-Span-193" class="mi">w</span><span id="MathJax-Span-194" class="mo">,</span><span id="MathJax-Span-195" class="mi">b</span><span id="MathJax-Span-196" class="mo">)</span></span><span id="MathJax-Span-197" class="mo">=</span><span id="MathJax-Span-198" class="munderover"><span id="MathJax-Span-199" class="mo">∑</span><span id="MathJax-Span-200" class="texatom"><span id="MathJax-Span-201" class="mrow"><span id="MathJax-Span-202" class="mi">n</span><span id="MathJax-Span-203" class="mo">=</span><span id="MathJax-Span-204" class="mn">1</span></span></span><span id="MathJax-Span-205" class="texatom"><span id="MathJax-Span-206" class="mrow"><span id="MathJax-Span-207" class="mi">N</span></span></span></span><span id="MathJax-Span-208" class="msubsup"><span id="MathJax-Span-209" class="mi">L</span><span id="MathJax-Span-210" class="texatom"><span id="MathJax-Span-211" class="mrow"><span id="MathJax-Span-212" class="mi">l</span><span id="MathJax-Span-213" class="mi">o</span><span id="MathJax-Span-214" class="mi">g</span><span id="MathJax-Span-215" class="mi">i</span><span id="MathJax-Span-216" class="mi">s</span><span id="MathJax-Span-217" class="mi">t</span><span id="MathJax-Span-218" class="mi">i</span><span id="MathJax-Span-219" class="mi">c</span></span></span></span><span id="MathJax-Span-220" class="mrow"><span id="MathJax-Span-221" class="mo">(</span><span id="MathJax-Span-222" class="msubsup"><span id="MathJax-Span-223" class="mi">y</span><span id="MathJax-Span-224" class="texatom"><span id="MathJax-Span-225" class="mrow"><span id="MathJax-Span-226" class="mi">n</span></span></span></span><span id="MathJax-Span-227" class="mrow"><span id="MathJax-Span-228" class="mo">(</span><span id="MathJax-Span-229" class="msubsup"><span id="MathJax-Span-230" class="mi">w</span><span id="MathJax-Span-231" class="texatom"><span id="MathJax-Span-232" class="mrow"><span id="MathJax-Span-233" class="mi">T</span></span></span></span><span id="MathJax-Span-234" class="msubsup"><span id="MathJax-Span-235" class="mi">x</span><span id="MathJax-Span-236" class="texatom"><span id="MathJax-Span-237" class="mrow"><span id="MathJax-Span-238" class="mi">n</span></span></span></span><span id="MathJax-Span-239" class="mo">+</span><span id="MathJax-Span-240" class="mi">b</span><span id="MathJax-Span-241" class="mo">)</span></span><span id="MathJax-Span-242" class="mo">)</span></span><span id="MathJax-Span-243" class="mo">=</span><span id="MathJax-Span-244" class="munderover"><span id="MathJax-Span-245" class="mo">∑</span><span id="MathJax-Span-246" class="texatom"><span id="MathJax-Span-247" class="mrow"><span id="MathJax-Span-248" class="mi">n</span><span id="MathJax-Span-249" class="mo">=</span><span id="MathJax-Span-250" class="mn">1</span></span></span><span id="MathJax-Span-251" class="texatom"><span id="MathJax-Span-252" class="mrow"><span id="MathJax-Span-253" class="mi">N</span></span></span></span><span id="MathJax-Span-254" class="mi">l</span><span id="MathJax-Span-255" class="mi">n</span><span id="MathJax-Span-256" class="mrow"><span id="MathJax-Span-257" class="mo">(</span><span id="MathJax-Span-258" class="mn">1</span><span id="MathJax-Span-259" class="mo">+</span><span id="MathJax-Span-260" class="msubsup"><span id="MathJax-Span-261" class="mi">e</span><span id="MathJax-Span-262" class="texatom"><span id="MathJax-Span-263" class="mrow"><span id="MathJax-Span-264" class="mo">−</span><span id="MathJax-Span-265" class="msubsup"><span id="MathJax-Span-266" class="mi">y</span><span id="MathJax-Span-267" class="texatom"><span id="MathJax-Span-268" class="mrow"><span id="MathJax-Span-269" class="mi">n</span></span></span></span><span id="MathJax-Span-270" class="mrow"><span id="MathJax-Span-271" class="mo">(</span><span id="MathJax-Span-272" class="msubsup"><span id="MathJax-Span-273" class="mi">w</span><span id="MathJax-Span-274" class="texatom"><span id="MathJax-Span-275" class="mrow"><span id="MathJax-Span-276" class="mi">T</span></span></span></span><span id="MathJax-Span-277" class="msubsup"><span id="MathJax-Span-278" class="mi">x</span><span id="MathJax-Span-279" class="texatom"><span id="MathJax-Span-280" class="mrow"><span id="MathJax-Span-281" class="mi">n</span></span></span></span><span id="MathJax-Span-282" class="mo">+</span><span id="MathJax-Span-283" class="mi">b</span><span id="MathJax-Span-284" class="mo">)</span></span></span></span></span><span id="MathJax-Span-285" class="mo">)</span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">F(w,b)=∑n=1NLlogistic(yn(wTxn+b))=∑n=1Nln(1+e−yn(wTxn+b))</span></span>

<span id="MathJax-Element-12-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>F</mi><mrow><mo>(</mo><mi>W</mi><mo>)</mo></mrow><mo>=</mo><munderover><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow></munderover><mi>l</mi><mi>n</mi><mrow><mo>(</mo><mn>1</mn><mo>+</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2260;</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow><mo>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msub><mo>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msup><mo>)</mo></mrow><mo>.</mo></math>"><span id="MathJax-Span-351" class="math"><span id="MathJax-Span-352" class="mrow"><span id="MathJax-Span-353" class="mi">F</span><span id="MathJax-Span-354" class="mrow"><span id="MathJax-Span-355" class="mo">(</span><span id="MathJax-Span-356" class="mi">W</span><span id="MathJax-Span-357" class="mo">)</span></span><span id="MathJax-Span-358" class="mo">=</span><span id="MathJax-Span-359" class="munderover"><span id="MathJax-Span-360" class="mo">∑</span><span id="MathJax-Span-361" class="texatom"><span id="MathJax-Span-362" class="mrow"><span id="MathJax-Span-363" class="mi">n</span><span id="MathJax-Span-364" class="mo">=</span><span id="MathJax-Span-365" class="mn">1</span></span></span><span id="MathJax-Span-366" class="texatom"><span id="MathJax-Span-367" class="mrow"><span id="MathJax-Span-368" class="mi">N</span></span></span></span><span id="MathJax-Span-369" class="mi">l</span><span id="MathJax-Span-370" class="mi">n</span><span id="MathJax-Span-371" class="mrow"><span id="MathJax-Span-372" class="mo">(</span><span id="MathJax-Span-373" class="mn">1</span><span id="MathJax-Span-374" class="mo">+</span><span id="MathJax-Span-375" class="munderover"><span id="MathJax-Span-376" class="mo">∑</span><span id="MathJax-Span-377" class="texatom"><span id="MathJax-Span-378" class="mrow"><span id="MathJax-Span-379" class="mi">k</span><span id="MathJax-Span-380" class="mo">≠</span><span id="MathJax-Span-381" class="msubsup"><span id="MathJax-Span-382" class="mi">y</span><span id="MathJax-Span-383" class="texatom"><span id="MathJax-Span-384" class="mrow"><span id="MathJax-Span-385" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-386" class="msubsup"><span id="MathJax-Span-387" class="mi">e</span><span id="MathJax-Span-388" class="texatom"><span id="MathJax-Span-389" class="mrow"><span id="MathJax-Span-390" class="msubsup"><span id="MathJax-Span-391" class="mrow"><span id="MathJax-Span-392" class="mo">(</span><span id="MathJax-Span-393" class="msubsup"><span id="MathJax-Span-394" class="mi">w</span><span id="MathJax-Span-395" class="texatom"><span id="MathJax-Span-396" class="mrow"><span id="MathJax-Span-397" class="mi">k</span></span></span></span><span id="MathJax-Span-398" class="mo">−</span><span id="MathJax-Span-399" class="msubsup"><span id="MathJax-Span-400" class="mi">w</span><span id="MathJax-Span-401" class="texatom"><span id="MathJax-Span-402" class="mrow"><span id="MathJax-Span-403" class="msubsup"><span id="MathJax-Span-404" class="mi">y</span><span id="MathJax-Span-405" class="texatom"><span id="MathJax-Span-406" class="mrow"><span id="MathJax-Span-407" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-408" class="mo">)</span></span><span id="MathJax-Span-409" class="texatom"><span id="MathJax-Span-410" class="mrow"><span id="MathJax-Span-411" class="mi">T</span></span></span></span><span id="MathJax-Span-412" class="msubsup"><span id="MathJax-Span-413" class="mi">x</span><span id="MathJax-Span-414" class="texatom"><span id="MathJax-Span-415" class="mrow"><span id="MathJax-Span-416" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-417" class="mo">)</span></span><span id="MathJax-Span-418" class="mo">.</span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">F(W)=∑n=1Nln(1+∑k≠yne(wk−wyn)Txn).</span></span>

<span id="MathJax-Element-20-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>g</mi><mrow><mo>(</mo><mi>W</mi><mo>)</mo></mrow><mo>=</mo><mi>l</mi><mi>n</mi><mrow><mo>(</mo><mn>1</mn><mo>+</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2260;</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow><mo>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msub><mo>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msup><mo>)</mo></mrow><mo>.</mo></math>"><span id="MathJax-Span-456" class="math"><span id="MathJax-Span-457" class="mrow"><span id="MathJax-Span-458" class="mi">g</span><span id="MathJax-Span-459" class="mrow"><span id="MathJax-Span-460" class="mo">(</span><span id="MathJax-Span-461" class="mi">W</span><span id="MathJax-Span-462" class="mo">)</span></span><span id="MathJax-Span-463" class="mo">=</span><span id="MathJax-Span-464" class="mi">l</span><span id="MathJax-Span-465" class="mi">n</span><span id="MathJax-Span-466" class="mrow"><span id="MathJax-Span-467" class="mo">(</span><span id="MathJax-Span-468" class="mn">1</span><span id="MathJax-Span-469" class="mo">+</span><span id="MathJax-Span-470" class="munderover"><span id="MathJax-Span-471" class="mo">∑</span><span id="MathJax-Span-472" class="texatom"><span id="MathJax-Span-473" class="mrow"><span id="MathJax-Span-474" class="mi">k</span><span id="MathJax-Span-475" class="mo">≠</span><span id="MathJax-Span-476" class="msubsup"><span id="MathJax-Span-477" class="mi">y</span><span id="MathJax-Span-478" class="texatom"><span id="MathJax-Span-479" class="mrow"><span id="MathJax-Span-480" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-481" class="msubsup"><span id="MathJax-Span-482" class="mi">e</span><span id="MathJax-Span-483" class="texatom"><span id="MathJax-Span-484" class="mrow"><span id="MathJax-Span-485" class="msubsup"><span id="MathJax-Span-486" class="mrow"><span id="MathJax-Span-487" class="mo">(</span><span id="MathJax-Span-488" class="msubsup"><span id="MathJax-Span-489" class="mi">w</span><span id="MathJax-Span-490" class="texatom"><span id="MathJax-Span-491" class="mrow"><span id="MathJax-Span-492" class="mi">k</span></span></span></span><span id="MathJax-Span-493" class="mo">−</span><span id="MathJax-Span-494" class="msubsup"><span id="MathJax-Span-495" class="mi">w</span><span id="MathJax-Span-496" class="texatom"><span id="MathJax-Span-497" class="mrow"><span id="MathJax-Span-498" class="msubsup"><span id="MathJax-Span-499" class="mi">y</span><span id="MathJax-Span-500" class="texatom"><span id="MathJax-Span-501" class="mrow"><span id="MathJax-Span-502" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-503" class="mo">)</span></span><span id="MathJax-Span-504" class="texatom"><span id="MathJax-Span-505" class="mrow"><span id="MathJax-Span-506" class="mi">T</span></span></span></span><span id="MathJax-Span-507" class="msubsup"><span id="MathJax-Span-508" class="mi">x</span><span id="MathJax-Span-509" class="texatom"><span id="MathJax-Span-510" class="mrow"><span id="MathJax-Span-511" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-512" class="mo">)</span></span><span id="MathJax-Span-513" class="mo">.</span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">g(W)=ln(1+∑k≠yne(wk−wyn)Txn).</span></span>

<span id="MathJax-Element-26-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mo>&amp;#x25BD;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></msub></mrow></msub><mi>g</mi><mrow><mo>(</mo><mi>W</mi><mo>)</mo></mrow><mo>=</mo><mfrac><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow><mo>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msub><mo>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msup><mrow><mn>1</mn><mo>+</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2260;</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow><mo>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow><mo>&amp;#x2032;</mo></msup></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msub><mo>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msup></mrow></mfrac><msubsup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msubsup><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>P</mi></mrow><mrow><mo>(</mo><mi>k</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mo>;</mo><mi>W</mi><mo>)</mo></mrow><msubsup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msubsup></math>"><span id="MathJax-Span-553" class="math"><span id="MathJax-Span-554" class="mrow"><span id="MathJax-Span-555" class="msubsup"><span id="MathJax-Span-556" class="mo">▽</span><span id="MathJax-Span-557" class="texatom"><span id="MathJax-Span-558" class="mrow"><span id="MathJax-Span-559" class="msubsup"><span id="MathJax-Span-560" class="mi">w</span><span id="MathJax-Span-561" class="texatom"><span id="MathJax-Span-562" class="mrow"><span id="MathJax-Span-563" class="mi">k</span></span></span></span></span></span></span><span id="MathJax-Span-564" class="mi">g</span><span id="MathJax-Span-565" class="mrow"><span id="MathJax-Span-566" class="mo">(</span><span id="MathJax-Span-567" class="mi">W</span><span id="MathJax-Span-568" class="mo">)</span></span><span id="MathJax-Span-569" class="mo">=</span><span id="MathJax-Span-570" class="mfrac"><span id="MathJax-Span-571" class="msubsup"><span id="MathJax-Span-572" class="mi">e</span><span id="MathJax-Span-573" class="texatom"><span id="MathJax-Span-574" class="mrow"><span id="MathJax-Span-575" class="msubsup"><span id="MathJax-Span-576" class="mrow"><span id="MathJax-Span-577" class="mo">(</span><span id="MathJax-Span-578" class="msubsup"><span id="MathJax-Span-579" class="mi">w</span><span id="MathJax-Span-580" class="texatom"><span id="MathJax-Span-581" class="mrow"><span id="MathJax-Span-582" class="mi">k</span></span></span></span><span id="MathJax-Span-583" class="mo">−</span><span id="MathJax-Span-584" class="msubsup"><span id="MathJax-Span-585" class="mi">w</span><span id="MathJax-Span-586" class="texatom"><span id="MathJax-Span-587" class="mrow"><span id="MathJax-Span-588" class="msubsup"><span id="MathJax-Span-589" class="mi">y</span><span id="MathJax-Span-590" class="texatom"><span id="MathJax-Span-591" class="mrow"><span id="MathJax-Span-592" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-593" class="mo">)</span></span><span id="MathJax-Span-594" class="texatom"><span id="MathJax-Span-595" class="mrow"><span id="MathJax-Span-596" class="mi">T</span></span></span></span><span id="MathJax-Span-597" class="msubsup"><span id="MathJax-Span-598" class="mi">x</span><span id="MathJax-Span-599" class="texatom"><span id="MathJax-Span-600" class="mrow"><span id="MathJax-Span-601" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-602" class="mrow"><span id="MathJax-Span-603" class="mn">1</span><span id="MathJax-Span-604" class="mo">+</span><span id="MathJax-Span-605" class="munderover"><span id="MathJax-Span-606" class="mo">∑</span><span id="MathJax-Span-607" class="texatom"><span id="MathJax-Span-608" class="mrow"><span id="MathJax-Span-609" class="msup"><span id="MathJax-Span-610" class="texatom"><span id="MathJax-Span-611" class="mrow"><span id="MathJax-Span-612" class="mi">k</span></span></span><span id="MathJax-Span-613" class="mo">′</span></span><span id="MathJax-Span-614" class="mo">≠</span><span id="MathJax-Span-615" class="msubsup"><span id="MathJax-Span-616" class="mi">y</span><span id="MathJax-Span-617" class="texatom"><span id="MathJax-Span-618" class="mrow"><span id="MathJax-Span-619" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-620" class="msubsup"><span id="MathJax-Span-621" class="mi">e</span><span id="MathJax-Span-622" class="texatom"><span id="MathJax-Span-623" class="mrow"><span id="MathJax-Span-624" class="msubsup"><span id="MathJax-Span-625" class="mrow"><span id="MathJax-Span-626" class="mo">(</span><span id="MathJax-Span-627" class="msubsup"><span id="MathJax-Span-628" class="mi">w</span><span id="MathJax-Span-629" class="texatom"><span id="MathJax-Span-630" class="mrow"><span id="MathJax-Span-631" class="msup"><span id="MathJax-Span-632" class="texatom"><span id="MathJax-Span-633" class="mrow"><span id="MathJax-Span-634" class="mi">k</span></span></span><span id="MathJax-Span-635" class="mo">′</span></span></span></span></span><span id="MathJax-Span-636" class="mo">−</span><span id="MathJax-Span-637" class="msubsup"><span id="MathJax-Span-638" class="mi">w</span><span id="MathJax-Span-639" class="texatom"><span id="MathJax-Span-640" class="mrow"><span id="MathJax-Span-641" class="msubsup"><span id="MathJax-Span-642" class="mi">y</span><span id="MathJax-Span-643" class="texatom"><span id="MathJax-Span-644" class="mrow"><span id="MathJax-Span-645" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-646" class="mo">)</span></span><span id="MathJax-Span-647" class="texatom"><span id="MathJax-Span-648" class="mrow"><span id="MathJax-Span-649" class="mi">T</span></span></span></span><span id="MathJax-Span-650" class="msubsup"><span id="MathJax-Span-651" class="mi">x</span><span id="MathJax-Span-652" class="texatom"><span id="MathJax-Span-653" class="mrow"><span id="MathJax-Span-654" class="mi">n</span></span></span></span></span></span></span></span></span><span id="MathJax-Span-655" class="msubsup"><span id="MathJax-Span-656" class="mi">x</span><span id="MathJax-Span-657" class="texatom"><span id="MathJax-Span-658" class="mrow"><span id="MathJax-Span-659" class="mi">T</span></span></span><span id="MathJax-Span-660" class="texatom"><span id="MathJax-Span-661" class="mrow"><span id="MathJax-Span-662" class="mi">n</span></span></span></span><span id="MathJax-Span-663" class="mo">=</span><span id="MathJax-Span-664" class="texatom"><span id="MathJax-Span-665" class="mrow"><span id="MathJax-Span-666" class="mi">P</span></span></span><span id="MathJax-Span-667" class="mrow"><span id="MathJax-Span-668" class="mo">(</span><span id="MathJax-Span-669" class="mi">k</span><span id="MathJax-Span-670" class="texatom"><span id="MathJax-Span-671" class="mrow"><span id="MathJax-Span-672" class="mo">|</span></span></span><span id="MathJax-Span-673" class="msubsup"><span id="MathJax-Span-674" class="mi">x</span><span id="MathJax-Span-675" class="texatom"><span id="MathJax-Span-676" class="mrow"><span id="MathJax-Span-677" class="mi">n</span></span></span></span><span id="MathJax-Span-678" class="mo">;</span><span id="MathJax-Span-679" class="mi">W</span><span id="MathJax-Span-680" class="mo">)</span></span><span id="MathJax-Span-681" class="msubsup"><span id="MathJax-Span-682" class="mi">x</span><span id="MathJax-Span-683" class="texatom"><span id="MathJax-Span-684" class="mrow"><span id="MathJax-Span-685" class="mi">T</span></span></span><span id="MathJax-Span-686" class="texatom"><span id="MathJax-Span-687" class="mrow"><span id="MathJax-Span-688" class="mi">n</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">▽wkg(W)=e(wk−wyn)Txn1+∑k′≠yne(wk′−wyn)TxnxnT=P(k|xn;W)xnT</span></span>

<span id="MathJax-Element-27-Frame" class="MathJax" style="box-sizing: border-box; display: inline-table; font-style: normal; font-weight: normal; line-height: normal; font-size: 14px; text-indent: 0px; text-align: center; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; position: relative;" tabindex="0" role="presentation" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mo>&amp;#x25BD;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></msub></mrow></msub><mi>g</mi><mrow><mo>(</mo><mi>W</mi><mo>)</mo></mrow><mo>=</mo><mfrac><mrow><mo>&amp;#x2212;</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2260;</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow><mo>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow><mo>&amp;#x2032;</mo></msup></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msub><mo>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msup></mrow><mrow><mn>1</mn><mo>+</mo><munder><mo>&amp;#x2211;</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow><mo>&amp;#x2032;</mo></msup><mo>&amp;#x2260;</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></munder><msup><mi>e</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow><mo>(</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow><mo>&amp;#x2032;</mo></msup></mrow></msub><mo>&amp;#x2212;</mo><msub><mi>w</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msub><mo>)</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msup><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub></mrow></msup></mrow></mfrac><msubsup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msubsup><mo>=</mo><mrow><mo>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi mathvariant=&quot;double-struck&quot;>P</mi></mrow><mrow><mo>(</mo><msub><mi>y</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow></msub><mo>;</mo><mi>W</mi><mo>)</mo></mrow><mo>&amp;#x2212;</mo><mn>1</mn><mo>)</mo></mrow><msubsup><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msubsup></math>"><span id="MathJax-Span-689" class="math"><span id="MathJax-Span-690" class="mrow"><span id="MathJax-Span-691" class="msubsup"><span id="MathJax-Span-692" class="mo">▽</span><span id="MathJax-Span-693" class="texatom"><span id="MathJax-Span-694" class="mrow"><span id="MathJax-Span-695" class="msubsup"><span id="MathJax-Span-696" class="mi">w</span><span id="MathJax-Span-697" class="texatom"><span id="MathJax-Span-698" class="mrow"><span id="MathJax-Span-699" class="mi">k</span></span></span></span></span></span></span><span id="MathJax-Span-700" class="mi">g</span><span id="MathJax-Span-701" class="mrow"><span id="MathJax-Span-702" class="mo">(</span><span id="MathJax-Span-703" class="mi">W</span><span id="MathJax-Span-704" class="mo">)</span></span><span id="MathJax-Span-705" class="mo">=</span><span id="MathJax-Span-706" class="mfrac"><span id="MathJax-Span-707" class="mrow"><span id="MathJax-Span-708" class="mo">−</span><span id="MathJax-Span-709" class="munderover"><span id="MathJax-Span-710" class="mo">∑</span><span id="MathJax-Span-711" class="texatom"><span id="MathJax-Span-712" class="mrow"><span id="MathJax-Span-713" class="msup"><span id="MathJax-Span-714" class="texatom"><span id="MathJax-Span-715" class="mrow"><span id="MathJax-Span-716" class="mi">k</span></span></span><span id="MathJax-Span-717" class="mo">′</span></span><span id="MathJax-Span-718" class="mo">≠</span><span id="MathJax-Span-719" class="msubsup"><span id="MathJax-Span-720" class="mi">y</span><span id="MathJax-Span-721" class="texatom"><span id="MathJax-Span-722" class="mrow"><span id="MathJax-Span-723" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-724" class="msubsup"><span id="MathJax-Span-725" class="mi">e</span><span id="MathJax-Span-726" class="texatom"><span id="MathJax-Span-727" class="mrow"><span id="MathJax-Span-728" class="msubsup"><span id="MathJax-Span-729" class="mrow"><span id="MathJax-Span-730" class="mo">(</span><span id="MathJax-Span-731" class="msubsup"><span id="MathJax-Span-732" class="mi">w</span><span id="MathJax-Span-733" class="texatom"><span id="MathJax-Span-734" class="mrow"><span id="MathJax-Span-735" class="msup"><span id="MathJax-Span-736" class="texatom"><span id="MathJax-Span-737" class="mrow"><span id="MathJax-Span-738" class="mi">k</span></span></span><span id="MathJax-Span-739" class="mo">′</span></span></span></span></span><span id="MathJax-Span-740" class="mo">−</span><span id="MathJax-Span-741" class="msubsup"><span id="MathJax-Span-742" class="mi">w</span><span id="MathJax-Span-743" class="texatom"><span id="MathJax-Span-744" class="mrow"><span id="MathJax-Span-745" class="msubsup"><span id="MathJax-Span-746" class="mi">y</span><span id="MathJax-Span-747" class="texatom"><span id="MathJax-Span-748" class="mrow"><span id="MathJax-Span-749" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-750" class="mo">)</span></span><span id="MathJax-Span-751" class="texatom"><span id="MathJax-Span-752" class="mrow"><span id="MathJax-Span-753" class="mi">T</span></span></span></span><span id="MathJax-Span-754" class="msubsup"><span id="MathJax-Span-755" class="mi">x</span><span id="MathJax-Span-756" class="texatom"><span id="MathJax-Span-757" class="mrow"><span id="MathJax-Span-758" class="mi">n</span></span></span></span></span></span></span></span><span id="MathJax-Span-759" class="mrow"><span id="MathJax-Span-760" class="mn">1</span><span id="MathJax-Span-761" class="mo">+</span><span id="MathJax-Span-762" class="munderover"><span id="MathJax-Span-763" class="mo">∑</span><span id="MathJax-Span-764" class="texatom"><span id="MathJax-Span-765" class="mrow"><span id="MathJax-Span-766" class="msup"><span id="MathJax-Span-767" class="texatom"><span id="MathJax-Span-768" class="mrow"><span id="MathJax-Span-769" class="mi">k</span></span></span><span id="MathJax-Span-770" class="mo">′</span></span><span id="MathJax-Span-771" class="mo">≠</span><span id="MathJax-Span-772" class="msubsup"><span id="MathJax-Span-773" class="mi">y</span><span id="MathJax-Span-774" class="texatom"><span id="MathJax-Span-775" class="mrow"><span id="MathJax-Span-776" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-777" class="msubsup"><span id="MathJax-Span-778" class="mi">e</span><span id="MathJax-Span-779" class="texatom"><span id="MathJax-Span-780" class="mrow"><span id="MathJax-Span-781" class="msubsup"><span id="MathJax-Span-782" class="mrow"><span id="MathJax-Span-783" class="mo">(</span><span id="MathJax-Span-784" class="msubsup"><span id="MathJax-Span-785" class="mi">w</span><span id="MathJax-Span-786" class="texatom"><span id="MathJax-Span-787" class="mrow"><span id="MathJax-Span-788" class="msup"><span id="MathJax-Span-789" class="texatom"><span id="MathJax-Span-790" class="mrow"><span id="MathJax-Span-791" class="mi">k</span></span></span><span id="MathJax-Span-792" class="mo">′</span></span></span></span></span><span id="MathJax-Span-793" class="mo">−</span><span id="MathJax-Span-794" class="msubsup"><span id="MathJax-Span-795" class="mi">w</span><span id="MathJax-Span-796" class="texatom"><span id="MathJax-Span-797" class="mrow"><span id="MathJax-Span-798" class="msubsup"><span id="MathJax-Span-799" class="mi">y</span><span id="MathJax-Span-800" class="texatom"><span id="MathJax-Span-801" class="mrow"><span id="MathJax-Span-802" class="mi">n</span></span></span></span></span></span></span><span id="MathJax-Span-803" class="mo">)</span></span><span id="MathJax-Span-804" class="texatom"><span id="MathJax-Span-805" class="mrow"><span id="MathJax-Span-806" class="mi">T</span></span></span></span><span id="MathJax-Span-807" class="msubsup"><span id="MathJax-Span-808" class="mi">x</span><span id="MathJax-Span-809" class="texatom"><span id="MathJax-Span-810" class="mrow"><span id="MathJax-Span-811" class="mi">n</span></span></span></span></span></span></span></span></span><span id="MathJax-Span-812" class="msubsup"><span id="MathJax-Span-813" class="mi">x</span><span id="MathJax-Span-814" class="texatom"><span id="MathJax-Span-815" class="mrow"><span id="MathJax-Span-816" class="mi">T</span></span></span><span id="MathJax-Span-817" class="texatom"><span id="MathJax-Span-818" class="mrow"><span id="MathJax-Span-819" class="mi">n</span></span></span></span><span id="MathJax-Span-820" class="mo">=</span><span id="MathJax-Span-821" class="mrow"><span id="MathJax-Span-822" class="mo">(</span><span id="MathJax-Span-823" class="texatom"><span id="MathJax-Span-824" class="mrow"><span id="MathJax-Span-825" class="mi">P</span></span></span><span id="MathJax-Span-826" class="mrow"><span id="MathJax-Span-827" class="mo">(</span><span id="MathJax-Span-828" class="msubsup"><span id="MathJax-Span-829" class="mi">y</span><span id="MathJax-Span-830" class="texatom"><span id="MathJax-Span-831" class="mrow"><span id="MathJax-Span-832" class="mi">n</span></span></span></span><span id="MathJax-Span-833" class="texatom"><span id="MathJax-Span-834" class="mrow"><span id="MathJax-Span-835" class="mo">|</span></span></span><span id="MathJax-Span-836" class="msubsup"><span id="MathJax-Span-837" class="mi">x</span><span id="MathJax-Span-838" class="texatom"><span id="MathJax-Span-839" class="mrow"><span id="MathJax-Span-840" class="mi">n</span></span></span></span><span id="MathJax-Span-841" class="mo">;</span><span id="MathJax-Span-842" class="mi">W</span><span id="MathJax-Span-843" class="mo">)</span></span><span id="MathJax-Span-844" class="mo">−</span><span id="MathJax-Span-845" class="mn">1</span><span id="MathJax-Span-846" class="mo">)</span></span><span id="MathJax-Span-847" class="msubsup"><span id="MathJax-Span-848" class="mi">x</span><span id="MathJax-Span-849" class="texatom"><span id="MathJax-Span-850" class="mrow"><span id="MathJax-Span-851" class="mi">T</span></span></span><span id="MathJax-Span-852" class="texatom"><span id="MathJax-Span-853" class="mrow"><span id="MathJax-Span-854" class="mi">n</span></span></span></span></span></span><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation">▽wkg(W)=−∑k′≠yne(wk′−wyn)Txn1+∑k′≠yne(wk′−wyn)TxnxnT=(P(yn|xn;W)−1)xnT</span></span>